

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Tutorial &mdash; planetplanet 1.0.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="planetplanet 1.0.0 documentation" href="index.html"/>
        <link rel="next" title="Scripts" href="scripts.html"/>
        <link rel="prev" title="Installation" href="install.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> planetplanet
          

          
          </a>

          
            
            
              <div class="version">
                1.0.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Tutorial</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#instantiating-a-planetary-system">Instantiating a planetary system</a></li>
<li class="toctree-l2"><a class="reference internal" href="#computing-orbits-and-light-curves">Computing orbits and light curves</a></li>
<li class="toctree-l2"><a class="reference internal" href="#computing-phase-curves">Computing phase curves</a></li>
<li class="toctree-l2"><a class="reference internal" href="#computing-planet-planet-occultations">Computing planet-planet occultations</a></li>
<li class="toctree-l2"><a class="reference internal" href="#hunting-for-occultations">Hunting for occultations</a></li>
<li class="toctree-l2"><a class="reference internal" href="#simulating-observations">Simulating observations</a></li>
<li class="toctree-l2"><a class="reference internal" href="#more-examples">More examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="scripts.html">Scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/rodluger/planetplanet">Github</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/rodluger/planetplanet/issues">Submit an issue</a></li>
<li class="toctree-l1"><a class="reference external" href="https://rodluger.github.io/planetplanet/PPOs.pdf">Read the paper</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">planetplanet</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">pp</a> &raquo;</li>
      
    
      <li>Tutorial</li>
    
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="tutorial">
<h1>Tutorial<a class="headerlink" href="#tutorial" title="Permalink to this headline">¶</a></h1>
<p>In this section I’ll go over some of the <code class="xref py py-obj docutils literal"><span class="pre">planetplanet</span></code> basics, like instantiating
a planetary system, computing orbits and light curves, and doing some simple plotting. Users are
encouraged to also check out the <a class="reference external" href="scripts.html">scripts</a> page for a collection of examples,
including several of the scripts used to plot the figures in the paper. Those scripts cover most
of the functionality of <code class="xref py py-obj docutils literal"><span class="pre">planetplanet</span></code>.</p>
<div class="section" id="instantiating-a-planetary-system">
<h2>Instantiating a planetary system<a class="headerlink" href="#instantiating-a-planetary-system" title="Permalink to this headline">¶</a></h2>
<p>After <a class="reference external" href="install.html">installing</a>, you can easily import <code class="xref py py-obj docutils literal"><span class="pre">planetplanet</span></code> in Python:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">planetplanet</span> <span class="kn">as</span> <span class="nn">pp</span>
</pre></div>
</div>
<p>The simplest thing you can do is to instantiate a one-planet system and compute some transit and
secondary eclipse light curves:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">star</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">Star</span><span class="p">(</span><span class="s1">&#39;star&#39;</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">planet</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">Planet</span><span class="p">(</span><span class="s1">&#39;planet&#39;</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="mf">1.</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="mf">1.</span><span class="p">,</span> <span class="n">per</span> <span class="o">=</span> <span class="mf">3.</span><span class="p">,</span> <span class="n">inc</span> <span class="o">=</span> <span class="mf">89.5</span><span class="p">,</span> <span class="n">t0</span> <span class="o">=</span> <span class="mf">4.</span><span class="p">)</span>
</pre></div>
</div>
<p>Here we’ve instantiated a star with mass 0.1 <span class="math">\(\mathrm{M_\odot}\)</span> and radius 0.1 <span class="math">\(\mathrm{R_\odot}\)</span>
– corresponding to an M7 (ish) dwarf. We’ve also given it the name “star”, which we will use to access
it later. We instantiated the planet with mass 1 <span class="math">\(\mathrm{M_\oplus}\)</span>, radius 1 <span class="math">\(\mathrm{R_\oplus}\)</span> –
i.e., an Earth-size planet. We gave it an inclination of 89.5 degrees and specified that the time of transit <code class="xref py py-obj docutils literal"><span class="pre">t0</span></code>
is at <span class="math">\(t = 4\)</span>. Note that by default, <a class="reference internal" href="api/structs.html#planetplanet.photo.structs.Star" title="planetplanet.photo.structs.Star"><code class="xref py py-class docutils literal"><span class="pre">Star</span></code></a> parameters
are specified in Solar units, while <a class="reference internal" href="api/structs.html#planetplanet.photo.structs.Planet" title="planetplanet.photo.structs.Planet"><code class="xref py py-class docutils literal"><span class="pre">Planet</span></code></a> parameters are specified
in Earth units. Check out the <a class="reference internal" href="api/structs.html#planetplanet.photo.structs.Star" title="planetplanet.photo.structs.Star"><code class="xref py py-class docutils literal"><span class="pre">Star</span></code></a> and <a class="reference internal" href="api/structs.html#planetplanet.photo.structs.Planet" title="planetplanet.photo.structs.Planet"><code class="xref py py-class docutils literal"><span class="pre">Planet</span></code></a>
classes for a description of all the available keywords and their default settings.</p>
<p>Next, we instantiate a <a class="reference internal" href="api/ppo.html#planetplanet.photo.ppo.System" title="planetplanet.photo.ppo.System"><code class="xref py py-class docutils literal"><span class="pre">System</span></code></a> object, which is the main gateway to the C
photodynamical routines:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">system</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">System</span><span class="p">(</span><span class="n">star</span><span class="p">,</span> <span class="n">planet</span><span class="p">,</span> <span class="n">distance</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<p>We’re telling <code class="xref py py-obj docutils literal"><span class="pre">planetplanet</span></code> that this planetary system is composed of a star and a planet, and that it’s at a distance
of 10 parsecs. Note that the <a class="reference internal" href="api/structs.html#planetplanet.photo.structs.Star" title="planetplanet.photo.structs.Star"><code class="xref py py-class docutils literal"><span class="pre">Star</span></code></a> instance must always come first; currently, only
one <a class="reference internal" href="api/structs.html#planetplanet.photo.structs.Star" title="planetplanet.photo.structs.Star"><code class="xref py py-class docutils literal"><span class="pre">Star</span></code></a> is allowed per system, as <code class="xref py py-obj docutils literal"><span class="pre">planetplanet</span></code> can’t yet handle binary
systems (but stay tuned!). Check out the <a class="reference internal" href="api/ppo.html#planetplanet.photo.ppo.System" title="planetplanet.photo.ppo.System"><code class="xref py py-class docutils literal"><span class="pre">System</span></code></a> class for a list of all available parameters.</p>
</div>
<div class="section" id="computing-orbits-and-light-curves">
<h2>Computing orbits and light curves<a class="headerlink" href="#computing-orbits-and-light-curves" title="Permalink to this headline">¶</a></h2>
<p>Now let’s compute the light curve over the span of ten days, at a cadence of 1.44 minutes:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">system</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
<span class="go">Computing orbits with the Kepler solver...</span>
<span class="go">[==================================================] 100% 1ms</span>
<span class="go">Computing occultation light curves...</span>
<span class="go">Done!</span>
</pre></div>
</div>
<p>Several things just happened. First, <code class="xref py py-obj docutils literal"><span class="pre">planetplanet</span></code> computed the orbital solution for the system over the given
time array using a Keplerian solver and stored the planet’s Cartesian coordinates in the <code class="xref py py-obj docutils literal"><span class="pre">x</span></code>, <code class="xref py py-obj docutils literal"><span class="pre">y</span></code>, and
<code class="xref py py-obj docutils literal"><span class="pre">z</span></code> attributes:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">planet</span><span class="o">.</span><span class="n">x</span>
<span class="go">array([-383.81118951, -384.2744517 , -384.73602829, ...,</span>
<span class="go">         -2.78460764,   -1.85641188,   -0.92820798])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">planet</span><span class="o">.</span><span class="n">y</span>
<span class="go">array([ 1.93374349,  1.92672441,  1.91969687, ...,</span>
<span class="go">       -3.86741063, -3.86745305, -3.86747849])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">planet</span><span class="o">.</span><span class="n">z</span>
<span class="go">array([ 221.58505598,  220.78074891,  219.97547339, ...,</span>
<span class="go">       -443.16136416, -443.16622404, -443.16913998])</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last"><code class="xref py py-obj docutils literal"><span class="pre">planetplanet</span></code> uses a <strong>left-handed</strong> Cartesian coordinate system. This is somewhat unconventional, but it is convenient in that the <strong>x</strong> axis points to the right on the sky, the <strong>y</strong> axis points up, and the <strong>z</strong> axis points <em>into</em> the sky. The observer is thus always at z = <span class="math">\(-\infty\)</span>. Prograde orbits proceed counter-clockwise when looking down the <strong>y</strong> axis. In practice this choice doesn’t matter, since the absolute sense of the orbit (and whether a planet is to the left or to the right of the star) cannot usually be established from photometry.</p>
</div>
<p>We can view the orbit by running</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">system</span><span class="o">.</span><span class="n">plot_orbits</span><span class="p">()</span>
</pre></div>
</div>
<div class="figure align-center">
<img alt="_images/quickstart-1.png" src="_images/quickstart-1.png" />
</div>
<p>The code also computed light curves for all occultation events. These are stored in the <code class="xref py py-obj docutils literal"><span class="pre">flux</span></code>
attributes of each of the bodies and in the <a class="reference internal" href="api/ppo.html#planetplanet.photo.ppo.System" title="planetplanet.photo.ppo.System"><code class="xref py py-class docutils literal"><span class="pre">System</span></code></a> instance:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">system</span><span class="o">.</span><span class="n">flux</span>
<span class="go">array([[  9.01190198e-15,   8.68430010e-15,   8.36835988e-15, ...]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">star</span><span class="o">.</span><span class="n">flux</span>
<span class="go">array([[  9.01190198e-15,   8.68430010e-15,   8.36835988e-15, ...]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">planet</span><span class="o">.</span><span class="n">flux</span>
<span class="go">array([[  0.,  0.,  0., ...]])</span>
</pre></div>
</div>
<p>The <code class="xref py py-obj docutils literal"><span class="pre">system.flux</span></code> attribute is the sum of the light curves of all bodies in the system. Note
that <code class="xref py py-obj docutils literal"><span class="pre">flux</span></code> is a two-dimensional array:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">system</span><span class="o">.</span><span class="n">flux</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(10000, 112)</span>
</pre></div>
</div>
<p>The first axis is the time axis (we computed stuff over 10,000 cadences); the second axis is the
wavelength axis. Though we didn’t specify it, <code class="xref py py-obj docutils literal"><span class="pre">planetplanet</span></code> computed the light curve
for the system over a grid of wavelengths:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">system</span><span class="o">.</span><span class="n">wavelength</span><span class="p">,</span> <span class="n">system</span><span class="o">.</span><span class="n">flux</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:])</span>
</pre></div>
</div>
<div class="figure align-center">
<img alt="_images/quickstart-2.png" src="_images/quickstart-2.png" />
</div>
<p>What we see is the Rayleigh-Jeans tail of the stellar flux. If we poke around in the docs, we see that
the default effective temperature for a <a class="reference internal" href="api/structs.html#planetplanet.photo.structs.Star" title="planetplanet.photo.structs.Star"><code class="xref py py-obj docutils literal"><span class="pre">Star</span></code></a> instance is 5577 K,
so this is the Sun’s blackbody spectrum. By default, <code class="xref py py-obj docutils literal"><span class="pre">planetplanet</span></code> computes light curves in the range
5 - 15 <span class="math">\(\mu\mathrm{m}\)</span> at a resolution <cite>R = 100</cite>. We can change these values when we call <code class="xref py py-obj docutils literal"><span class="pre">compute()</span></code>:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">system</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">lambda1</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">lambda2</span> <span class="o">=</span> <span class="mi">15</span><span class="p">,</span> <span class="n">R</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">system</span><span class="o">.</span><span class="n">wavelength</span><span class="p">,</span> <span class="n">system</span><span class="o">.</span><span class="n">flux</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pl</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="figure align-center">
<img alt="_images/quickstart-3.png" src="_images/quickstart-3.png" />
</div>
<p>Now let’s look at the system light curve at a given wavelength over the entire time array:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">system</span><span class="o">.</span><span class="n">plot_lightcurve</span><span class="p">(</span><span class="n">wavelength</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
</pre></div>
</div>
<div class="figure align-center">
<img alt="_images/quickstart-4.png" src="_images/quickstart-4.png" />
</div>
<p>Three transits and three secondary eclipses are clearly visible. Clicking on one of the
events brings up an interactive window. This is what you get when you click on a transit:</p>
<a class="reference internal image-reference" href="_images/transit.gif"><img alt="_images/transit.gif" class="align-center" src="_images/transit.gif" style="width: 400px;" /></a>
<p>At the top, we see the orbital configuration at the time of transit (observer toward the
bottom); in the middle, we see an animation of the event; and at the bottom, the event
light curve. Note that the image of the star reflects the limb darkening parameters <code class="xref py py-obj docutils literal"><span class="pre">planetplanet</span></code> assumed,
<cite>u1 = 1</cite> and <cite>u2 = 0</cite> (see <a class="reference internal" href="api/structs.html#planetplanet.photo.structs.Star" title="planetplanet.photo.structs.Star"><code class="xref py py-obj docutils literal"><span class="pre">Star</span></code></a>). By default,
limb darkening coefficients can be specified up to any order as a Taylor expansion in the
quantity <span class="math">\((1 - \mu) = (1 - \cos\phi)\)</span>, where <span class="math">\(\phi\)</span> is the viewing angle:</p>
<div class="math">
\[B_\lambda(\mu) = B_\lambda^0 \left[ 1 - \sum_{i=1}^{n} u_i(\lambda) (1 - \mu)^i \right]\]</div>
<p>Different limb darkening parameters can be specified when instantiating a
<a class="reference internal" href="api/structs.html#planetplanet.photo.structs.Star" title="planetplanet.photo.structs.Star"><code class="xref py py-obj docutils literal"><span class="pre">Star</span></code></a> object via the <code class="xref py py-obj docutils literal"><span class="pre">limbdark</span></code>
keyword. Note that <code class="xref py py-obj docutils literal"><span class="pre">planetplanet</span></code> also allows users to specify wavelength-dependent limb
darkening coefficients. See <a class="reference external" href="scripts/mutual_transit.html">this script</a> for an example.</p>
</div>
<div class="section" id="computing-phase-curves">
<h2>Computing phase curves<a class="headerlink" href="#computing-phase-curves" title="Permalink to this headline">¶</a></h2>
<p>We can also plot the phase curve for the planet in the examples above, but we would have
needed to specify <cite>phasecurve = True</cite> when instantiating it. Alternatively, we can just
set the attribute directly:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">planet</span><span class="o">.</span><span class="n">phasecurve</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">system</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">lambda1</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">lambda2</span> <span class="o">=</span> <span class="mi">15</span><span class="p">,</span> <span class="n">R</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">system</span><span class="o">.</span><span class="n">plot_lightcurve</span><span class="p">(</span><span class="n">wavelength</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<div class="figure align-center">
<img alt="_images/quickstart-5.png" src="_images/quickstart-5.png" />
</div>
<p>By default, planets are instantiated with the <code class="xref py py-obj docutils literal"><span class="pre">RadiativeEquilibriumMap</span></code>
surface map with an <a class="reference internal" href="api/structs.html#planetplanet.photo.structs.Planet" title="planetplanet.photo.structs.Planet"><code class="xref py py-class docutils literal"><span class="pre">albedo</span></code></a> of <cite>0.3</cite> and a nightside temperature
<a class="reference internal" href="api/structs.html#planetplanet.photo.structs.Planet" title="planetplanet.photo.structs.Planet"><code class="xref py py-class docutils literal"><span class="pre">tnight</span></code></a> of <cite>40</cite> K. The latter two can be passed as keywords to the
<a class="reference internal" href="api/structs.html#planetplanet.photo.structs.Planet" title="planetplanet.photo.structs.Planet"><code class="xref py py-class docutils literal"><span class="pre">Planet</span></code></a> class or specified directly by setting the respective attributes. The
<code class="xref py py-obj docutils literal"><span class="pre">RadiativeEquilibriumMap</span></code> surface map computes radiances assuming
instant re-readiation, which is valid for planets with atmospheres that have negligible thermal inertia and negligible recirculation
(i.e., the airless planet limit). These are “eyeball” planets, which look like <a class="reference external" href="scripts/eyeball_orbit.html">this</a>.
Alternatively, users may specify</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">planet</span><span class="o">.</span><span class="n">radiancemap</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">LimbDarkenedMap</span><span class="p">()</span>
</pre></div>
</div>
<p>to treat the planet as a limb-darkened body, whose emission is always symmetric about the center of the planet disk, regardless of
the orbital phase or viewing angle. In this case, no phase curve is visible:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">planet</span><span class="o">.</span><span class="n">phasecurve</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">system</span><span class="o">.</span><span class="n">plot_lightcurve</span><span class="p">(</span><span class="n">wavelength</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<div class="figure align-center">
<img alt="_images/quickstart-6.png" src="_images/quickstart-6.png" />
</div>
<p>Because of the generalized integration scheme in <code class="xref py py-obj docutils literal"><span class="pre">planetplanet</span></code>, users can also specify custom surface maps, provided they
are radially symmetric about the hotspot (which need not point toward the star!). Check out this <a class="reference external" href="scripts/custom_map.html">script</a>.</p>
<div class="figure align-center">
<img alt="_images/quickstart-7.png" src="_images/quickstart-7.png" />
</div>
</div>
<div class="section" id="computing-planet-planet-occultations">
<h2>Computing planet-planet occultations<a class="headerlink" href="#computing-planet-planet-occultations" title="Permalink to this headline">¶</a></h2>
<p>Finally, let’s look at how we compute planet-planet occultation (PPO) light curves for the TRAPPIST-1 system. The
<a class="reference internal" href="api/trappist1.html#module-planetplanet.photo.trappist1" title="planetplanet.photo.trappist1"><code class="xref py py-mod docutils literal"><span class="pre">trappist1</span></code></a> module contains utilities for instantiating the TRAPPIST-1
planetary system:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">system</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">Trappist1</span><span class="p">(</span><span class="n">sample</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="mi">543210</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that I specified <code class="xref py py-obj docutils literal"><span class="pre">sample</span> <span class="pre">=</span> <span class="pre">True</span></code>, meaning we will draw at random from the prior on all the orbital
parameters (if <code class="xref py py-obj docutils literal"><span class="pre">sample</span> <span class="pre">=</span> <span class="pre">False</span></code>, the mean values are used for all parameters). The prior is currently informed
by the observational constraints on the system from Gillon et al. (2017),
Luger et al. (2017), and Burgasser &amp; Mamajek (2017), as well as on the Monte Carlo simulations in Luger, Lustig-Yaeger
and Agol (2017) for the planets’ mutual inclinations. First, let’s look at the orbits:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">system</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">system</span><span class="o">.</span><span class="n">plot_orbits</span><span class="p">()</span>
</pre></div>
</div>
<div class="figure align-center">
<img alt="_images/quickstart-8.png" src="_images/quickstart-8.png" />
</div>
<p>The plot in the lower left-hand corner is the view from Earth. We can also plot the full system light curve as before:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">system</span><span class="o">.</span><span class="n">plot_lightcurve</span><span class="p">(</span><span class="n">wavelength</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
</pre></div>
</div>
<div class="figure align-center">
<img alt="_images/quickstart-9.png" src="_images/quickstart-9.png" />
</div>
<p>All the occultations are labeled: the label text indicates the occulted body, while the label color indicates the
occultor (black, red, orange, yellow, green, aqua, light blue, dark blue, for the star and each of the seven planets,
respectively). Transits are thus labeled with “A” (for the star) and secondary eclipses are labeled with the planet
name and colored black. There are several interesting features in the light curve: a simultaneous secondary eclipse of
b and c at 1.6 days, a simultaneous transit of b and e at 5.3 days, and two prominent planet-planet occultations of c by
b at 1.3 and 1.87 days. If we click on the one at 1.87 days, we can see its light curve:</p>
<a class="reference internal image-reference" href="_images/ppo.gif"><img alt="_images/ppo.gif" class="align-center" src="_images/ppo.gif" style="width: 400px;" /></a>
<p>Note that by default we display the flux normalized to the planet’s total emission at full phase. The
<code class="xref py py-obj docutils literal"><span class="pre">flux</span></code> attribute of planet c contains the actual flux in <span class="math">\(\mathrm{W/m^2}\)</span> if that’s what
you need.</p>
</div>
<div class="section" id="hunting-for-occultations">
<h2>Hunting for occultations<a class="headerlink" href="#hunting-for-occultations" title="Permalink to this headline">¶</a></h2>
<p>The last thing we’ll go over here is how to use <code class="xref py py-obj docutils literal"><span class="pre">planetplanet</span></code> to predict when PPOs occur. We
make this easy via the <code class="xref py py-obj docutils literal"><span class="pre">next_occultation()</span></code> method,
which returns the times (and durations) of the next <code class="xref py py-obj docutils literal"><span class="pre">N</span></code> occultations of a given body in the system.
This <a class="reference external" href="scripts/next_occultation.html">example script</a> shows how to do this. You can easily sort the results
to find the longest upcoming occultation, which for a given instance of the system can reveal fun events like
this prograde-retrograde occultation of TRAPPIST-1c by TRAPPIST-1b lasting <em>5 hours</em>!</p>
<a class="reference internal image-reference" href="_images/retro.gif"><img alt="_images/retro.gif" class="align-center" src="_images/retro.gif" style="width: 400px;" /></a>
</div>
<div class="section" id="simulating-observations">
<h2>Simulating observations<a class="headerlink" href="#simulating-observations" title="Permalink to this headline">¶</a></h2>
<p>Now we will cover how to compute synthetic observations of <code class="xref py py-obj docutils literal"><span class="pre">planetplanet</span></code>
light curves with the James Webb Space Telescope (JWST)  Mid-Infrared Instrument
(MIRI) Imager. After running <code class="xref py py-obj docutils literal"><span class="pre">compute()</span></code> on a <a class="reference internal" href="api/ppo.html#planetplanet.photo.ppo.System" title="planetplanet.photo.ppo.System"><code class="xref py py-class docutils literal"><span class="pre">System</span></code></a>
instance, simply call <code class="xref py py-obj docutils literal"><span class="pre">observe()</span></code>:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">stack</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">filter</span> <span class="o">=</span> <span class="s1">&#39;f1500w&#39;</span><span class="p">,</span> <span class="n">alpha_err</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="go">Computing observed light curve in F1500W filter...</span>
<span class="go">Average lightcurve precision: 222.090 ppm</span>
</pre></div>
</div>
<div class="figure align-center">
<img alt="_images/quickstart-10.png" src="_images/quickstart-10.png" />
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Make sure that <code class="xref py py-obj docutils literal"><span class="pre">compute()</span></code> was run with a wavelength range
that fully covers any filters you may want to use. Otherwise an
<cite>AssertionError</cite> will be thrown when you run <code class="xref py py-obj docutils literal"><span class="pre">observe()</span></code>.</p>
</div>
<p>We can explore all the available MIRI filters and plot their throughput curves:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">miri_filters</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">jwst</span><span class="o">.</span><span class="n">get_miri_filter_wheel</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="nb">filter</span> <span class="ow">in</span> <span class="n">miri_filters</span><span class="p">:</span> <span class="k">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> : </span><span class="si">%.1f</span><span class="s2"> um&quot;</span> <span class="o">%</span><span class="p">(</span><span class="nb">filter</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="nb">filter</span><span class="o">.</span><span class="n">eff_wl</span><span class="p">))</span>
<span class="go">F560W : 5.6 um</span>
<span class="go">F770W : 7.7 um</span>
<span class="go">F1000W : 10.0 um</span>
<span class="go">F1130W : 11.3 um</span>
<span class="go">F1280W : 12.8 um</span>
<span class="go">F1500W : 15.1 um</span>
<span class="go">F1800W : 18.0 um</span>
<span class="go">F2100W : 20.8 um</span>
<span class="go">F2550W : 25.4 um</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">miri_filters</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<div class="figure align-center">
<img alt="_images/quickstart-11.png" src="_images/quickstart-11.png" />
</div>
<p><a class="reference internal" href="api/jwst.html#planetplanet.detect.jwst.Filter" title="planetplanet.detect.jwst.Filter"><code class="xref py py-class docutils literal"><span class="pre">Filter</span></code></a> objects can also be passed
to <code class="xref py py-obj docutils literal"><span class="pre">observe()</span></code>:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="nb">filter</span> <span class="o">=</span> <span class="n">miri_filters</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
</pre></div>
</div>
<p>After <code class="xref py py-obj docutils literal"><span class="pre">observe()</span></code> has run, the <a class="reference internal" href="api/ppo.html#planetplanet.photo.ppo.System" title="planetplanet.photo.ppo.System"><code class="xref py py-class docutils literal"><span class="pre">system</span></code></a>
will have the <a class="reference internal" href="api/jwst.html#planetplanet.detect.jwst.Filter" title="planetplanet.detect.jwst.Filter"><code class="xref py py-class docutils literal"><span class="pre">Filter</span></code></a> as an attribute
with an instantiated <code class="xref py py-class docutils literal"><span class="pre">Lightcurve</span></code>
containing various useful quantities. For instance, the number of photons detected
from the system <cite>Nsys</cite> and the number of background photons <cite>Nback</cite> are given by:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">system</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">lightcurve</span><span class="o">.</span><span class="n">Nsys</span>
<span class="go">array([ 23620244.09945266,  23620230.07335656,  23620216.03934677, ...,</span>
<span class="go">     23613770.63008701,  23613761.01311478,  23613751.41684124])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">system</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">lightcurve</span><span class="o">.</span><span class="n">Nback</span>
<span class="go">array([ 3892306.56855529,  3892306.56855529,  3892306.56855529, ...,</span>
<span class="go">     3892306.56855313,  3892306.56856005,  3892306.56856005])</span>
</pre></div>
</div>
<p>which are a function of <cite>time</cite>:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">system</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">lightcurve</span><span class="o">.</span><span class="n">time</span>
<span class="go">array([  0.00000000e+00,   1.00000000e-03,   2.00000000e-03, ...,</span>
<span class="go">      9.49700000e+00,   9.49800000e+00,   9.49900000e+00])</span>
</pre></div>
</div>
</div>
<div class="section" id="more-examples">
<h2>More examples<a class="headerlink" href="#more-examples" title="Permalink to this headline">¶</a></h2>
<p>That’s all for the tutorial (for now), though we’ll keep adding features to <code class="xref py py-obj docutils literal"><span class="pre">planetplanet</span></code> and
posting updated info here. Make sure to check out the <a class="reference external" href="scripts.html">scripts</a> page for more examples
and some advanced usage information. And there’s always the <a class="reference external" href="api.html">API</a> if you’re feeling adventurous
or would like to adapt <code class="xref py py-mod docutils literal"><span class="pre">planetplanet</span></code> for your needs!</p>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="scripts.html" class="btn btn-neutral float-right" title="Scripts" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="install.html" class="btn btn-neutral" title="Installation" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Rodrigo Luger.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.0.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>